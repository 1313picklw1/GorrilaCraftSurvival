<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GorrilaCraftSurvival</title>
    <style>
        body { margin: 0; overflow: hidden; }
        #info {
            position: absolute;
            top: 10px;
            left: 10px;
            color: #fff;
            font-family: Arial, sans-serif;
            font-size: 16px;
        }
    </style>
</head>
<body>
    <div id="info">
        <div>Score: <span id="score">0</span></div>
    </div>
    <!-- Load Three.js -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/build/three.min.js"></script>
    <!-- Load OrbitControls -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <!-- Load GLTFLoader -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
    <!-- Load TextureLoader -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/TextureLoader.js"></script>

    <script>
        // Basic setup
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer();
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);

        // Controls
        const controls = new THREE.OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;
        controls.dampingFactor = 0.25;
        controls.enableZoom = true;

        // Load textures
        async function loadTextures() {
            const response = await fetch('https://username.github.io/repository/textures/textures.json');
            const data = await response.json();

            const textures = {};
            const textureLoader = new THREE.TextureLoader();

            for (const path of data.textures) {
                const textureName = path.split('/').pop().split('.')[0];
                textures[textureName] = textureLoader.load(path);
            }

            return textures;
        }

        // Load 3D model
        const loader = new THREE.GLTFLoader();
        let gorilla;
        function loadGorillaModel() {
            loader.load('https://username.github.io/repository/models/gorilla.glb', (gltf) => {
                gorilla = gltf.scene;
                gorilla.scale.set(1, 1, 1);
                scene.add(gorilla);
                gorilla.position.set(0, 1, 0);
                camera.position.set(0, 10, 15);
                camera.lookAt(0, 0, 0);
            });
        }

        // Generate simple world
        function generateWorld(width, depth, blockSize, textures) {
            for (let x = 0; x < width; x++) {
                for (let z = 0; z < depth; z++) {
                    let height = Math.sin(x * 0.1) * Math.cos(z * 0.1) * 5;
                    let texture;
                    if (height > 1) {
                        texture = textures.grass;
                    } else if (height > 0) {
                        texture = textures.dirt;
                    } else {
                        texture = textures.stone;
                    }

                    const geometry = new THREE.BoxGeometry(blockSize, blockSize, blockSize);
                    const material = new THREE.MeshBasicMaterial({ map: texture });
                    const block = new THREE.Mesh(geometry, material);
                    block.position.set(x * blockSize, height * blockSize, z * blockSize);
                    scene.add(block);
                }
            }
        }

        // Game logic
        let resources = [];
        let score = 0;
        function addResources(textures) {
            for (let i = 0; i < 10; i++) {
                const texture = i % 2 === 0 ? textures.dirt : textures.stone;
                const geometry = new THREE.BoxGeometry(0.5, 0.5, 0.5);
                const material = new THREE.MeshBasicMaterial({ map: texture });
                const resource = new THREE.Mesh(geometry, material);
                resource.position.set(Math.random() * 20 - 10, 0.25, Math.random() * 20 - 10);
                scene.add(resource);
                resources.push(resource);
            }
        }

        function update() {
            if (gorilla) {
                resources.forEach((resource, index) => {
                    if (gorilla.position.distanceTo(resource.position) < 1) {
                        scene.remove(resource);
                        resources.splice(index, 1);
                        score++;
                        document.getElementById('score').textContent = score;
                    }
                });

                if (resources.length === 0) {
                    alert('You collected all resources! Game Over!');
                    resetGame();
                }
            }

            controls.update();
            renderer.render(scene, camera);
            requestAnimationFrame(update);
        }

        function resetGame() {
            scene.clear();
            initGame();
            score = 0;
            document.getElementById('score').textContent = score;
        }

        document.addEventListener('keydown', (event) => {
            if (gorilla) {
                switch (event.key) {
                    case 'ArrowUp':
                        gorilla.position.z -= 0.5;
                        break;
                    case 'ArrowDown':
                        gorilla.position.z += 0.5;
                        break;
                    case 'ArrowLeft':
                        gorilla.position.x -= 0.5;
                        break;
                    case 'ArrowRight':
                        gorilla.position.x += 0.5;
                        break;
                }
            }
        });

        // Initialize game
        async function initGame() {
            const textures = await loadTextures();
            generateWorld(20, 20, 1, textures);
            addResources(textures);
            loadGorillaModel();
        }

        initGame();
        update();
    </script>
</body>
</html>
